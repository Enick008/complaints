<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <link href="https://fonts.googleapis.com/css2?family=Prompt&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Prompt', sans-serif; }
    header img { height: 100px; width: auto; }
  </style>
</head>
<body class="bg-red-50">
  <header class="bg-white py-4 shadow-md flex justify-center">
    <img src="https://upload.wikimedia.org/wikipedia/commons/b/b1/Seal_of_Ko_Samui.png" alt="Seal of Ko Samui">
  </header>

  <main class="max-w-5xl mx-auto p-4">
    <div class="tabs flex border-b mb-4">
      <button class="tab px-4 py-2 font-bold text-red-700 border-b-4 border-red-700" onclick="switchTab('formTab')">‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</button>
      <button class="tab px-4 py-2" onclick="switchTab('statsTab')">‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥</button>
    </div>

    <section id="formTab">
      <form id="complaintForm" class="bg-white p-6 rounded-lg shadow-md">
        <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
          <div><label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏£‡∏±‡∏ö‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á</label><input type="date" id="date" class="w-full border p-2 rounded" required></div>
          <div><label>‡πÄ‡∏•‡∏Ç‡∏•‡∏á‡∏£‡∏±‡∏ö</label><input type="text" id="refNo" class="w-full border p-2 rounded" required></div>
          <div><label>‡∏ä‡∏∑‡πà‡∏≠</label><input type="text" id="name" class="w-full border p-2 rounded" required></div>
          <div><label>‡∏ó‡∏µ‡πà‡∏≠‡∏¢‡∏π‡πà</label><input type="text" id="address" class="w-full border p-2 rounded"></div>
          <div>
            <label>‡∏ï‡∏≥‡∏ö‡∏•</label>
            <select id="subdistrict" class="w-full border p-2 rounded">
              <option>‡∏≠‡πà‡∏≤‡∏á‡∏ó‡∏≠‡∏á</option><option>‡∏•‡∏¥‡∏õ‡∏∞‡∏ô‡πâ‡∏≠‡∏¢</option><option>‡∏ï‡∏•‡∏¥‡πà‡∏á‡∏á‡∏≤‡∏°</option>
              <option>‡πÅ‡∏°‡πà‡∏ô‡πâ‡∏≥</option><option>‡∏ö‡πà‡∏≠‡∏ú‡∏∏‡∏î</option><option>‡∏°‡∏∞‡πÄ‡∏£‡πá‡∏ï</option><option>‡∏´‡∏ô‡πâ‡∏≤‡πÄ‡∏°‡∏∑‡∏≠‡∏á</option>
            </select>
          </div>
          <div><label>‡πÄ‡∏ö‡∏≠‡∏£‡πå‡πÇ‡∏ó‡∏£</label><input type="tel" id="phone" class="w-full border p-2 rounded"></div>
          <div>
            <label>‡∏ù‡πà‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label>
            <select id="department" class="w-full border p-2 rounded">
              <option>‡∏á‡∏≤‡∏ô‡∏ö‡∏£‡∏¥‡∏´‡∏≤‡∏£‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ</option><option>‡∏ù‡πà‡∏≤‡∏¢‡∏õ‡∏£‡∏±‡∏ö‡∏õ‡∏£‡∏∏‡∏á‡∏Ñ‡∏∏‡∏ì‡∏†‡∏≤‡∏û‡∏ô‡πâ‡∏≥</option><option>‡∏ù‡πà‡∏≤‡∏¢‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏™‡∏¥‡πà‡∏á‡πÅ‡∏ß‡∏î‡∏•‡πâ‡∏≠‡∏°‡∏î‡πâ‡∏≤‡∏ô‡∏ß‡∏±‡∏™‡∏î‡∏∏‡πÉ‡∏ä‡πâ‡πÅ‡∏•‡πâ‡∏ß</option>
            </select>
          </div>
          <div>
            <label>‡∏™‡∏ñ‡∏≤‡∏ô‡∏∞</label>
            <select id="status" class="w-full border p-2 rounded">
              <option>‡∏≠‡∏¢‡∏π‡πà‡∏£‡∏∞‡∏´‡∏ß‡πà‡∏≤‡∏á‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</option><option>‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß</option>
            </select>
          </div>
          <div><label>‡∏ú‡∏π‡πâ‡∏£‡∏±‡∏ö‡∏ú‡∏¥‡∏î‡∏ä‡∏≠‡∏ö</label><input type="text" id="assignee" class="w-full border p-2 rounded"></div>
          <div class="md:col-span-2">
            <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</label>
            <textarea id="details" class="w-full border p-2 rounded" rows="3"></textarea>
          </div>
          <div id="completedSection" class="md:col-span-2 hidden">
            <label>‡∏ß‡∏±‡∏ô‡∏ó‡∏µ‡πà‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</label>
            <input type="date" id="completeDate" class="w-full border p-2 rounded">
            <label>‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏≤‡∏£‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£</label>
            <textarea id="resolution" class="w-full border p-2 rounded" rows="2"></textarea>
          </div>
        </div>
        <div class="mt-4 text-right">
          <button type="submit" class="bg-red-600 text-white px-6 py-2 rounded hover:bg-red-700">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å</button>
        </div>
      </form>
    </section>

    <section id="statsTab" class="hidden">
      <div class="bg-white p-6 rounded-lg shadow-md">
        <h2 class="text-xl font-bold mb-4">üìä ‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô</h2>
        <canvas id="complaintChart" height="120"></canvas>
      </div>
    </section>
  </main>

  <footer class="text-center bg-red-100 py-4 mt-6 text-sm text-red-800">
    ¬©2025 ‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á‡πÄ‡∏£‡∏µ‡∏¢‡∏ô ‡∏Å‡∏≠‡∏á‡∏ä‡πà‡∏≤‡∏á‡∏™‡∏∏‡∏Ç‡∏≤‡∏†‡∏¥‡∏ö‡∏≤‡∏• ‡πÇ‡∏î‡∏¢ ‡∏ô‡∏≤‡∏¢‡∏ò‡∏µ‡∏£‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏û‡∏π‡∏•‡πÄ‡∏Ç‡∏≤‡∏•‡πâ‡∏≤‡∏ô
  </footer>

  <script>
    const scriptURL = 'https://script.google.com/macros/s/AKfycbw4LM0Ig-Pr1VhiheafQfX3hu8rzwWZhPUXa1n17oO7rq6OQJ6WTjcoOsyrCVLdRww/exec';

    document.getElementById('status').addEventListener('change', function () {
      document.getElementById('completedSection').classList.toggle('hidden', this.value !== '‡∏î‡∏≥‡πÄ‡∏ô‡∏¥‡∏ô‡∏Å‡∏≤‡∏£‡πÅ‡∏•‡πâ‡∏ß');
    });

    function switchTab(tabId) {
      document.getElementById('formTab').classList.add('hidden');
      document.getElementById('statsTab').classList.add('hidden');
      document.getElementById(tabId).classList.remove('hidden');
    }

    document.getElementById('complaintForm').addEventListener('submit', async function (e) {
      e.preventDefault();

      const data = {
        date: document.getElementById('date').value,
        refNo: document.getElementById('refNo').value,
        name: document.getElementById('name').value,
        address: document.getElementById('address').value,
        subdistrict: document.getElementById('subdistrict').value,
        phone: document.getElementById('phone').value,
        department: document.getElementById('department').value,
        status: document.getElementById('status').value,
        assignee: document.getElementById('assignee').value,
        details: document.getElementById('details').value,
        completeDate: document.getElementById('completeDate').value,
        resolution: document.getElementById('resolution').value
      };

      try {
        Swal.fire({ title: '‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å...', allowOutsideClick: false, didOpen: () => Swal.showLoading() });

        const res = await fetch(scriptURL, {
          method: 'POST',
          headers: { 'Content-Type': 'application/json' },
          body: JSON.stringify({ action: 'addComplaint', data })
        });

        const result = await res.json();
        if (result.success) {
          Swal.fire('‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à!', '‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢‡πÅ‡∏•‡πâ‡∏ß', 'success');
          document.getElementById('complaintForm').reset();
        } else {
          throw new Error(result.message);
        }
      } catch (error) {
        Swal.fire('‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î', error.message, 'error');
      }
    });
  </script>
</body>
</html>
